define("ui/overlay",["jquery","mod/emitter"],function($,Emitter){function Overlay(opts){Emitter.call(this);var self=this;this.opts=opts,this.el=$(tmpl).appendTo("body");var klass=this.opts.klass;this.opts.klass&&this.el.addClass(klass),this.body=this.el.find(".k-slave"),this.closable=void 0!==opts.closable?!!opts.closable:!0,this.setBody(),this.closable&&(this.el.on("click",".lnk-close",function(e){e.preventDefault(),self.close()}),doc.on("click.overlay","#ark-overlay",function(e){e.target===e.currentTarget&&self.close()}).on("keyup.overlay",function(e){/input|textarea/i.test(e.target.tagName)||27!==e.keyCode||self.close()}))}function exports(opts){return opts=opts||{},new exports.Overlay(opts)}var tmpl='<div id="ark-overlay" class="hide"><div class="k-stick"></div><div class="k-content"><div class="k-slave"></div></div></div>',doc=$(document),docRoot=$("html");return $.extend(Overlay.prototype,{close:function(){return this.el.remove(),docRoot.removeClass("ark-overlay"),doc.off(".overlay"),this.emit("close"),this},getContentElement:function(){return this.el.find(".k-content")},open:function(){return this.scrollTop=doc.scrollTop(),docRoot.addClass("ark-overlay"),this.el.removeClass("hide"),this.emit("open"),this},setBody:function(body){return body=body||this.opts.body,this.body.html(body),this}}),Emitter(Overlay.prototype),exports.Overlay=Overlay,exports});